---
title: "CTIS Validation Analysis"
author: ""
date: "17/1/2022"
output: 
  pdf_document: default
  html_document: default
  word_document: default
bibliography: references.bib
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = F, message = F, warning = F, fig.height = 7, fig.width = 12, fig.align = "centre")

library(targets)

library(here)
library(tidyverse)
library(vroom)
library(lubridate)
library(janitor)
library(epiprocess)

library(tidyquant)
library(patchwork)

library(gtsummary)
library(gt)

library(srvyr)
options(survey.lonely.psu="adjust")

theme_set(theme_minimal())
```

```{r data}
tar_load(c19_vaccine_merged)
tar_load(c19_covid_merged)
tar_load(ctis_india_public)

south_states <- c("Andhra Pradesh", "Telangana", "Maharashtra", "Kerala", "Karnataka", "Tamil Nadu")
north_states <- c("Bihar", "Uttar Pradesh", "Madhya Pradesh", "Gujarat", "Rajasthan", "Haryana")

comparable_states <- c("Andhra Pradesh", "Bihar", "Gujarat", "Karnataka", "Kerala", "Madhya Pradesh", "Maharashtra", "Rajasthan", "Tamil Nadu", "Telangana", "Uttar Pradesh", "West Bengal")

```

# Abstract

# Introduction

The COVID-19 pandemic and the ensuing crisis has been quantified like no previous crisis, not dissimilar to its societal impact. As the pandemic hit, Governments, business organizations and researchers from various fields across the world faced an urgent need to collect data on assessing the impact of the pandemic and the response at all levels - countries, states, households, individuals. However, interviewer administered, face-to-face surveys of general population which were commonplace prior to the crisis were no longer feasible due to non-pharmaceutical interventions such as physical distancing and lockdowns. At the same time, the widespread use of mobile phones provided alternate modes data collection for research to meet the demands generated by the pandemic. With the opportunity of conducting surveys remotely during the national lockdown when there was a need for scientifically collected data for decision making in the wake of the COVID-19 pandemic, several public and private organizations launched remote modes of surveys and the existing ones which were fielding face-to-face interviews also transitioned their surveys to remote modes of data collection. In the absence of face-to-face surveys, the remote modes of data collection filled this void and satisfied the need of a quick turnaround in the absence of travel time and helped in informing policy response in a timely manner.

However, the validity and reliability of the estimates generated by remote modes of data collection have not been established due to incomplete coverage of population having access to mobile phones and self selection resulting from response bias [@tsuboi2015; @bethlehem2010]. In a recent paper in Nature, Bradley et al. report that larger sample sizes do not protect against bias [@bradley2021]. Using vaccination estimates from three different surveys in the United States by comparing them with benchmark CDC numbers, Bradely et al. demonstrate that two of the three surveys with large sample sizes significantly overestimated the vaccine uptake. Further, they provide evidence on two key issues related to vaccination estimates from surveys - 1) The difference in vaccination estimates of the two large surveys compared to the benchmark CDC numbers increased over time. This shows that that the magnitude of survey errors increased over time and 2) The relative estimates between subgroups of the population i.e., states in the US and 18-64 age group were no better than absolute estimates. Taken together, these findings suggest that both the absolute estimates and relative estimates over space and time for the two large surveys are biased and do not accurately represent the ground truths.

One of the surveys which Bradley et al. utilise is Facebook's COVID-19 Trends and Impact Survey (abbreviated to CTIS which was earlier referred to as COVID-19 Symptom Survey abbreviated to CSS) which is conducted in partnership with Carnegie Mellion University in the United States and University of Maryland (UMD) globally. CTIS is the largest public health survey till date conducted daily in more than 200 countries or territories globally and the survey estimates are used widely in research and to formulate public health policy [@salomon2021; @sukumaran2021; @adjodah2021; @babalola2021]. Our earlier work, following the news about vaccine breakthrough to fight the Coronavirus, also leveraged data from the CTIS to present estimates of vaccine hesitancy in India across states and for the survey time period [@chowdhury]. Given the paucity of data that existed then, the CTIS has been a useful tool for us in understanding and tracking the changing nature of the pandemic and the public response to it.

In light of Bradley et. al's work, we examine the CTIS estimates for India and the compare them with available information in COVID-19 administrative data recorded in the CoWIN application portal. Governments at state and national level in India release aggregated data of CoWIN application data in the form of daily bulletins which are further consolidated by a crowdsourced volunteer group called COVID19Bharat. In the following section, we present results from two validation exercises comparing CTIS estimates in India to the widely used official public health metrics obtained from COVID19Bharat.

# Results

## Vaccine uptake estimates comparison

The CTIS questionnaire includes two questions on vaccination which can be compared to official estimates of COVID-19 Vaccination. Firstly, all respondents are asked whether they had a COVID-19 vaccination with yes, no and don't know as response choices. Bradley et al. use the estimates from responses to this question to estimate the vaccine uptake (of at least one dose) for CTIS-US. Further, if answered in positive to the earlier question, the respondent is further probed on how many COVID-19 vaccinations he/she has received with 1 dose, 2 doses and don't know as response choices. Strictly speaking, comparisons with respondents who have taken at least dose are more likely to align with official estimates of one dose of vaccination given the way the questions are probed. However, we also present results of percentage of respondents who have responded with two doses with official estimates of second dose of vaccination at the national level.

In Figure 1, we present the comparison of CTIS and Official Estimates of COVID-19 Vaccination by one and two doses of vaccination at the National Level. The official estimates are scaled to the eligible target group of people above 18 years old using the Census projections for the year 2021 published by the Government of India. Similar to Bradley et al., we observe the vaccine uptake in CTIS to be higher than in the administrative data. However, while the estimates at earlier time points diverge greatly due to coming from a low base and the CTIS sample characteristics, the divergence between CTIS decreases over time as more adults in the general population are vaccinated. The scaling factors of excess vaccination uptake for one dose and two doses at March 2021 stand at 8 and 120 respectively. By April-May 2021, the excess vaccine uptake in CTIS falls to 2 and 15 and continues the downward trend until October 2021.

```{r fig-vaccine-uptake, fig.cap="Vaccine Uptake in India - CTIS Estimates and Administrative Data Comparison"}

fig_1d <- c19_vaccine_merged %>% 
  filter(state == "All Regions") %>% 
  mutate(wt_pct_covid_vaccine_recieved_min = wt_pct_covid_vaccine_recieved + wt_pct_se_covid_vaccine_recieved,
         wt_pct_covid_vaccine_recieved_max = wt_pct_covid_vaccine_recieved + wt_pct_se_covid_vaccine_recieved) %>% 
  ggplot() +
  geom_line(aes(date, wt_pct_covid_vaccine_recieved, color = "blue")) +
  geom_ribbon(aes(x = date, ymin = wt_pct_covid_vaccine_recieved_min, ymax = wt_pct_covid_vaccine_recieved_max), alpha=0.4) +
  geom_line(aes(date, x1d, color = "red")) +
  geom_hline(aes(yintercept = 1), show.legend = F) +
  #geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_y_continuous(labels = scales::percent_format()) + 
  scale_color_discrete(name = "", labels = c("CTIS Estimates", "Official Data")) +
  labs(title = "One Dose", x = "", y = "") +
  theme(plot.title = element_text(face = "bold"),
        legend.position = "bottom")

fig_2d <- c19_vaccine_merged %>% 
  filter(state == "All Regions") %>% 
  mutate(wt_pct_covid_vaccine_twodoses_min = wt_pct_covid_vaccine_twodoses + wt_pct_se_covid_vaccine_twodoses,
         wt_pct_covid_vaccine_twodoses_max = wt_pct_covid_vaccine_twodoses + wt_pct_se_covid_vaccine_twodoses) %>% 
  ggplot() +
  geom_line(aes(date, wt_pct_covid_vaccine_twodoses, color = "blue")) +
  geom_ribbon(aes(x = date, ymin = wt_pct_covid_vaccine_twodoses_min, ymax = wt_pct_covid_vaccine_twodoses_max), alpha=0.4) +
  geom_line(aes(date, x2d, color = "red")) +
  geom_hline(aes(yintercept = 1), show.legend = F) +
  #geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_y_continuous(labels = scales::percent_format()) + 
  scale_color_discrete(name = "", labels = c("CTIS Estimates", "Official Data")) +
  labs(title = "Two Doses", x = "", y = "") +
  theme(plot.title = element_text(face = "bold"),
        legend.position = "bottom")

c19_vaccine_merged_scaling <- c19_vaccine_merged %>% 
  mutate(scale_1d = if_else(x1d == 0, 0, wt_pct_covid_vaccine_recieved/x1d),
         scale_2d = if_else(x2d == 0, 0, wt_pct_covid_vaccine_twodoses/x2d)) 

fig_scale_1d <- c19_vaccine_merged_scaling %>% 
  filter(state == "All Regions" & date >= "2021-03-01") %>% 
  ggplot() +
  geom_line(aes(date, scale_1d), show.legend = F) +
  labs(title = "Scaling Factor - One Dose", 
       x = "", 
       y = "") +
  theme(plot.title = element_text(face = "bold"))

fig_scale_2d <- c19_vaccine_merged_scaling %>% 
  filter(state == "All Regions" & date >= "2021-03-01") %>% 
  ggplot() +
  geom_line(aes(date, scale_2d), show.legend = F) +
  labs(title = "Scaling Factor - Two Doses", 
       x = "", 
       y = "") 

(fig_1d + fig_scale_1d)/ (fig_2d + fig_scale_2d) + 
  plot_layout(widths = c(2, 1)) 

```

\pagebreak

The convergence in estimates can be explained by a couple of factors. The COVID-19 vaccination rollout was initially restricted to self-registration on the CoWIN application. While the rollout was extremely useful in gathering information about the vaccinated, this perhaps had an unintended effect of increasing the divergence in vaccination rates between rural and urban areas due to the existing digital divide according to multiple news reports [@correspondent2021; @sharma2021]. This is also observed in CTIS data which is shown in Figure 2. From the CTIS microdata, we plot the 7 day moving average vaccination rates by place of residence for respondents on whom there is complete data for both questions. Vaccination rates in rural areas catch up with the urban cities and towns in the second half of the year according to the CTIS microdata estimates. An important caveat here is that urbanicity is not used in the weighting procedure to correct for the sample bias which we discuss more in the section on study design and sample representativeness.

```{r fig-vaccine-compare, fig.cap="Vaccine Uptake in India by place of residence - CTIS Estimates"}

v1_e2_estimates_full <- vroom::vroom(here("data/vaccination_urbanicity_estimates.csv"))

v1_e2_estimates_full  %>% 
  filter(v1 == "Yes") %>% 
  ggplot() +
  #geom_line(aes(date, proportion, color = e2)) +
  geom_ma(n = 7, linetype = 1, aes(date, proportion, color = e2)) +
  scale_y_continuous(labels = scales::percent_format()) + 
  #scale_color_discrete(name = "", labels = c("CTIS Estimates", "Official Data")) +
  labs(title = "Vaccine Uptake in India by place of residence", 
       subtitle = "CTIS Estimates",
       x = "", y = "", color = "") +
  theme(plot.title = element_text(face = "bold"),
        legend.position = "bottom")

```

At the state level, we observe a similar convergence in trends over time with some exceptions. Due to small sample sizes, CTIS estimates have missing data for smaller states (by population size) on some days. Accounting for that, we plot the 7-day moving average of CTIS trends versus the official state level vaccination for the select states (determined by population sizes) in Figure 4. The CTIS picks up the trends in early movers such as Kerala and Madhya Pradesh which complete 90% first dose coverage by October 2021. In almost all the states, the CTIS estimates start higher and plateau earlier than the trends in the official vaccination numbers.

```{r fig-vaccine-uptake-states, fig.cap="Vaccine Uptake in Indian States - CTIS Estimates and Administrative Data Comparison"}
c19_vaccine_merged %>% 
  #filter(state != "All Regions") %>% 
  filter(state %in% comparable_states) %>% 
  ggplot() +
  #geom_point(aes(date, wt_pct_covid_vaccine_recieved, color = "blue" alpha=0.1)) +
  #geom_line(aes(date, wt_pct_covid_vaccine_recieved, color = "blue")) +
  geom_ma(aes(date, wt_pct_covid_vaccine_recieved, color = "blue"), N = 7, linetype = 1) +
  geom_line(aes(date, x1d, color = "red")) +
  geom_hline(aes(yintercept = 1), show.legend = F) +
  facet_wrap(~ state) +
  scale_y_continuous(labels = scales::percent_format()) + 
  scale_color_discrete(name = "", labels = c("CTIS Estimates", "Official Data")) +
  labs(title = "One Dose", x = "", y = "") +
  theme(plot.title = element_text(face = "bold"),
        legend.position = "bottom")

```

\pagebreak

As Bradley et al. note, one benefit of large sample, repeated cross-sectional surveys such as CTIS can be to compare estimates of spatial and demographic subgroups. To determine the validity of relative CTIS vaccination estimates versus the official numbers, we plot the daily Spearman correlation coefficient obtained from rank tests of states over time in Figure 5. To smoothen the noisy daily correlations, we also plot the 15-day moving average of the daily points. The 15-day moving average of Spearman rank correlation which starts from a low base improves to nearly 0.45 till wave 2 in April, 2021 and then declines to nearly 0.15 in the following three months as a result of rapid uptake in vaccination in certain states and subgroups during the panic of delta wave. In the "normal" months subsequent to the delta wave starting August 2021, the correlations range between 0.1-0.4. As the states converge to a full dose of first vaccination, we observe a wider dispersion of daily correlations suggesting that the CTIS estimates may not be fully or accurately capturing the final mile of vaccination among the remaining pockets of the population.

```{r fig-correlation-states, fig.cap="Daily state rank correlation over time"}

c19_vaccine_epidf <- c19_vaccine_merged %>% 
  filter(date <= max(date) - 4) %>% 
  #filter(state != "All Regions") %>% 
  filter(state %in% comparable_states) %>% 
  rename(geo_value = state, time_value = date) %>% 
  as.epi_df(geo_type = "state",
            time_type = "day",
            issue = max(c19_vaccine_merged$date))

z1 <- epi_cor(c19_vaccine_epidf, 
              x1d, 
              wt_pct_covid_vaccine_recieved, 
              by = time_value, method = "spearman")

ggplot(z1, aes(x = time_value, y = cor)) +
  geom_point(aes(alpha = 0.1), show.legend = F) +
  #geom_smooth() +
  geom_ma(n = 15, linetype = 1, size = 2) +
  scale_x_date(minor_breaks = "month", date_labels = "%b %y") +
  labs(title = "Correlation over time",
       subtitle = "CTIS and Official Estimates",
       x = "Date", y = " Spearman Correlation Coefficient") +
  theme(plot.title = element_text(face = "bold"))

```

\pagebreak

## CLI and COVID-19 Cases

The original rationale behind CTIS as mentioned in the documentation is that since experiencing symptoms is often a precursor to going to the hospital or getting more seriously ill, if this works, it can produce a weekly forecast how many cases hospitals will see in the days ahead, as well as an early indicator of where the outbreak is growing and where the curve is being successfully flattened. Several studies on symptom tracking and forecasting COVID cases [@reinhart; @salomon2021; @menni2020; @sukumaran2021].

In order to track the symptoms, the CTIS asks respondents 14 questions on various symptoms and if they have experienced any of them in the 24 hours prior to taking the survey. Facebook-UMD construct an indicator named COVID-like Illness (CLI) based on the percentage of positive responses to 3 of these 14 symptoms namely fever, along with cough, shortness of breath, or difficulty breathing. Facebook-UMD provide daily estimates of percentage of survey respondents that have reported COVID-like illness (CLI) publicly.

In Figure 6, we present the comparison of CLI with official COVID-19 diagnostic metrics. During Wave-2 in India amidst the emergence of delta variant between April-June 2021, both cases and deaths peak sequentially and plateau to a relatively low level after that period. We see that 7-day moving average of percentage of respondents with CLI trend also form a crest and a trough mirroring the cases. However, while reported cases and deaths have collapsed post wave 2 in June 2021, the percentage of respondents with CLI has not and moreover it keeps increasing past the peak seen during wave 2 reaching a peak of nearly 6% in November 2021. We also note that while testing has decreased post wave-2, the decrease is relatively small and not enough to entirely explain this divergence.

```{r fig-covid-cli-india, fig.cap="CLI - Comparison with COVID-19 Diagnostic Data"}

fig_covid_india <- c19_covid_merged %>% 
  filter(state == "All Regions") %>% 
  ggplot(aes(date, confirmed_d)) + 
  geom_line() +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  labs(title = "COVID Cases - India", x = "Date", y = "Daily Cases") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_death_india <- c19_covid_merged %>% 
  filter(state == "All Regions") %>% 
  ggplot(aes(date, deceased_d)) + 
  geom_line() +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  labs(title = "COVID Deaths - India", x = "Date", y = "Daily Deaths") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_tests_india <- c19_covid_merged %>% 
  filter(state == "All Regions") %>% 
  filter(date <= "2021-12-07") %>% 
  ggplot(aes(date, tested_d)) + 
  geom_line() +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  labs(title = "COVID Testing - India", x = "Date", y = "Daily Testing") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_cli_india <- c19_covid_merged %>% 
  filter(state == "All Regions") %>% 
  ggplot(aes(date, wt_pct_covid)) + 
  #geom_point() + 
  #geom_smooth() +
  #geom_line() +
  geom_ma(n = 7, linetype = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  scale_y_continuous(labels = scales::label_percent()) +
  labs(title = "COVID Like Illness (CLI) - India", x = "", y = "CLI (in%)") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
  
fig_covid_cli_india <- (fig_covid_india + fig_death_india)/ ( fig_cli_india+ fig_tests_india) + 
  plot_annotation(
    title = 'COVID-19 Diagnostic and CTIS-CLI trends in India')
  
fig_covid_cli_india

```

In Figure 7, we present at the CLI trend at state level by northern (Gujarat is included in the northern states although it lies in western India strictly speaking) and southern states. We observe that while the 7-day moving average CLI trend for southern states remains steady at relatively low levels, CLI trend in the northern states keeps increasing post wave 2 which contributes majorly to the overall national CLI. There are two questions at play here - 1) Why do we see an persistence of trend in the CLI trends at national level when daily COVID-19 cases have fallen? 2) Secondly, irrespective of question 1, why do the northern and southern states exhibit different trends in CLI post wave 2, ceteris paribus.

```{r fig-cli-states, fig.cap="Reported CLI - Indian States"}

fig_cli_south <- ctis_india_public %>% 
  filter(indicator == "covid") %>% 
  filter(region %in% south_states) %>% 
  ggplot() + 
  geom_ma(aes(date, wt_pct), n = 7, linetype = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  scale_y_continuous(limits = c(0, 0.2), labels = scales::label_percent()) +
  facet_wrap(~ region) + 
  labs(title = "Southern States", x = "", y = "CLI (in%)") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
  
fig_cli_north <- ctis_india_public %>% 
  filter(indicator == "covid") %>% 
  filter(region %in% north_states) %>% 
  ggplot() + 
  geom_ma(aes(date, wt_pct), n = 7, linetype = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  scale_y_continuous(limits = c(0, 0.2), labels = scales::label_percent()) +
  facet_wrap(~ region) + 
  labs(title = "Northern States", x = "", y = "CLI (in%)") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_cli_states <- fig_cli_north + fig_cli_south

fig_cli_states + 
  plot_annotation(
    title = 'COVID Like Illness (CLI) Symptoms',
    subtitle = "Trend over time in select states of India") & 
  theme(plot.title = element_text(face = "bold"))


```

One potential hypothesis is the confounding of symptoms between COVID-19 and seasonal flu. Although the symptoms of COVID-19 are similar to those of the seasonal flu, including chest pains, fatigue, fever, and a persistent cough, the addition of anosmia, the loss of anosmia and dysgeusia, or smell and taste has been shown to be an important indicator of whether an individual has been affected with COVID-19 [\@menni2020]. Whether respondent has had Anosmia in 24 hours prior to the interview is one of the 14 questions on symptoms asked in CTIS. In Figure 8, we plot the 7-day moving average of percentage of respondents in the selected states who have reported Anosmia as a symptom. Similar to CLI trends, we see a major divergence in the trends by northern and southern states.

```{r fig-anos-states, fig.cap="Reported Anosmia - Indian States"}

fig_anos_north <- ctis_india_public %>% 
  filter(indicator == "anosmia") %>% 
  filter(region %in% north_states) %>% 
  ggplot() +
  #geom_point(aes(alpha = 0.1)) +
  geom_ma(aes(date, wt_pct), ma_fun = SMA, n = 7, linetype = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") + 
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  scale_y_continuous(limits = c(0, 0.2), labels = scales::percent_format()) +
  facet_wrap(~ region) + 
  labs(title = "Northern States", x = "", y = "Reported Anosmia (in%)") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_anos_south <- ctis_india_public %>% 
  filter(indicator == "anosmia") %>% 
  filter(region %in% south_states) %>% 
  ggplot() +
  #geom_point(aes(alpha = 0.1)) +
  geom_ma(aes(date, wt_pct), ma_fun = SMA, n = 7, linetype = 1) +
  geom_vline(xintercept = as.numeric(as.Date("2021-04-15")), linetype=4, color = "red") +
  scale_x_date(limits = as.Date(c("2020-04-01", "2021-12-31")), date_labels = "%b-%Y") +
  scale_y_continuous(limits = c(0, 0.2), labels = scales::percent_format()) +
  facet_wrap(~ region) + 
  labs(title = "Southern States", x = "", y = "Reported Anosmia (in%)") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

fig_anos_states <- fig_anos_north + fig_anos_south

fig_anos_states + 
  plot_annotation(
    title = 'Anosmia Reported Symptom',
    subtitle = "Trend over time in select states of India") & 
  theme(plot.title = element_text(face = "bold"))

```

\pagebreak

# Discussion

In this section, we discuss the study design and sample representativeness of CTIS and conclude by listing some possible learnings for future survey research.

## Study Design & Sample Representativeness

CTIS is an opt-in survey of Facebook users of over 2 billion monthly users over 18 years of age sampled from Facebook's Active User Base (FAUB). CTIS employs a repeated cross section design to draw new random sample of users daily. There could be repetition of survey request to the same users (particularly in small states), but should be treated as a new sample. To select daily sample, stratified random sampling is considered (strata being the states) in order to provide representative sample at the national level. While the proportion of females and older subgroups is lower in the FAUB, FB-UMD use a two-step weighting procedure to account for this. The objective of constructing weights is to provide a weight per respondent so that respondents of CSS better represent the target population.

Table 1 presents the unweighted and weighted sample characteristics by interview completion status for a randomly selected daily sample from December 1, 2021. We see that the two-step weighting procedure partially corrects the bias in gender and age groups (to a lesser extent) represented in the CTIS samples. However, urbanicity a key demographic variable is not used in the weighting procedure by FB-UMD. Most of the respondents in FAUB are from cities and as a result of not accounting for this, the estimates are skewed towards urban population. The education variable also cannot be used in analysis for the way it is probed and coded.

```{r table-ctis-sample-characteristics}

ctis_dec1 <- vroom(here("data/2021-12-01_full.csv.gz")) %>% 
  clean_names() 

ctis_dec1_india <- ctis_dec1 %>% 
  filter(country_agg == "India")

ctis_dec1_india_labelled <- ctis_dec1_india %>%
  #filter(finished == "1") %>% 
  mutate(e2 = factor(e2),
         e3 = factor(e3),
         e4 = factor(e4),
         finished = factor(finished)) %>% 
  mutate(e2 = fct_relevel(e2, "-77", after = Inf),
         e3 = fct_relevel(e3, "-77", after = Inf),
         e4 = fct_relevel(e4, "-77", after = Inf)) %>% 
  mutate(e2 = fct_relevel(e2, "-99", after = Inf),
         e3 = fct_relevel(e3, "-99", after = Inf),
         e4 = fct_relevel(e4, "-99", after = Inf)) %>% 
  mutate(finished = fct_recode(finished, 
                               "Incomplete" = "0",
                               "Completed" = "1")) %>% 
  mutate(e2 = fct_recode(e2, 
                         "City" = "1",
                         "Town" = "2",
                         "Village or rural area" = "3",
                         "Seen but unanswered" = "-77",
                         "Missing" = "-99")) %>% 
  mutate(e3 = fct_recode(e3, 
                         "Male" = "1",
                         "Female" = "2",
                         #"Other" = "3",
                         "Prefer not to answer" = "4",
                         "Seen but unanswered" = "-77",
                         "Missing" = "-99")) %>% 
  mutate(e4 = fct_recode(e4, 
                         "18-24" = "1",
                         "25-34" = "2",
                         "35-44" = "3",
                         "45-54" = "4",
                         "55-64" = "5",
                         "65-74" = "6",
                         ">=75 years" = "7",
                         "Seen but unanswered" = "-77",
                         "Missing" = "-99")) 

ctis_dec1_india_svy <- ctis_dec1_india_labelled %>% 
  as_survey_design(1,
                   strata = region_agg,
                   weight = weight) 

ctis_table_unwt <- ctis_dec1_india_labelled %>%
  tbl_summary(
    # stratify summary statistics by the "finished" column
    by = finished, 
    # summarize a subset of the columns
    include = c(e3, e4, e2),
    statistic = list(all_categorical() ~ "{n} ({p}%)"),
    # adding labels to table
    label = list(e3 ~ "Respondent Gender",
                 e4 ~ "Respondent Age Group",
                 e2 ~ "Area of Residence")
  ) %>% 
  modify_caption("**CTIS - Sample Characteristics**") %>%
  bold_labels() 

ctis_table_wt <- ctis_dec1_india_svy %>%
  tbl_svysummary(
    # stratify summary statistics by the "finished" column
    by = finished, 
    # summarize a subset of the columns
    include = c(e3, e4, e2),
    statistic = list(all_categorical() ~ "{p}%"),
    # adding labels to table
    label = list(e3 ~ "Respondent Gender",
                 e4 ~ "Respondent Age Group",
                 e2 ~ "Area of Residence")
  ) %>% 
  modify_caption("**CTIS - Sample Characteristics**") %>%
  modify_header(stat_by = "**{level}**") %>%
  bold_labels() 

ctis_table <- tbl_merge(list(ctis_table_unwt, ctis_table_wt),
                        tab_spanner = c("**Unweighted Estimates**", "**Weighted Estimates**")) %>%
  as_gt() %>%
  gt::tab_options(
    table.width = pct(100)
  ) %>%
  gt::tab_source_note(gt::md("*Sample characteristics represent the latest daily sample of December 01, 2021*"))

ctis_table
```

Another major limitation of CTIS is that the demographic details of the respondents are probed at the end of the interview (this is corrected in version 12 of the survey). Owing to this structure of CTIS survey design, the sample characteristics for most non-respondents are missing both at item and unit level. Facebook's original sample frame (FAUB) from which the respondents are selected does have this information and more however, this information is not shared with researchers. This poses a major limitation on any analysis of CTIS data in its current form as it is impossible to get any sense of the non-respondents in the survey.

## Surveys and Gold Standards

Results from validation of CTIS estimates indicate that the vaccination estimates from CTIS certainly inflated compared to the actual numbers. Further, the CTIS samples is also biased towards more educated, internet savvy, urban respondents even after correction for survey non-response and individuals who are not on the Facebook platform. However, this does not imply that the CTIS data is no longer useful and or that it cannot be taken seriously. We think otherwise and present our reasoning with an example where the symptom trends observed in the CTIS diverge from the official estimates and the administrative estimates cannot be considered as goldstandard. It is unclear at this moment as to why the percentage of respondent with CLI keeps increasing post wave 2. There are several hypothesis including the persistence of symptoms in long covid patients [@carfì2020; @sudre2021], role of absolute humidity and seasonality in the COVID-19 transmission dynamics [@shaman2020; @liu2021; @baker2021; @phillips2021] . Unlike in the case of vaccination, the official COVID-19 diagnostic numbers cannot be substituted for a gold standard.

While the COVID official diagnostic numbers such as cases, deaths, tested are much less of a "gold standard" compared to the vaccination numbers ([@karlinsky2021]), they are used widely used to track the progress of the pandemic despite their short comings [@serikbayeva2021]. For instance, test positivity rate is a widely used metric which suffers from selection bias in testing and test positivity rates has been documented [@wälde; @díaz-pachón2021]. In India, even the peak of about 3 million daily tests falls well short of the total population at 1.3 billion and an adult population of more than 900 million. Further, state's action or the lack of it in mounting an appropriate response has a considerable effect on outcomes [@serikbayeva2021; @shah2021]. In Figure 8, we show the wide range of inter-state responses using total number of tests per adult population as a crude proxy of the state response in testing.

```{r fig-testing-per-adult, fig.cap="Testing per adult - Select Indian States"}

c19_covid_merged %>% 
  #filter(state %in% comparable_states & date == "2021-12-31") %>% 
  filter(state != "All Regions" & date == "2021-12-30") %>% 
  mutate(state = fct_reorder(state, xtested)) %>% 
  ggplot() +
  geom_col(aes(state, xtested)) +
  coord_flip() +
  scale_y_continuous(labels = scales::percent_format()) +
  labs(title = "Tests per adult population - Indian States",
       x = "",
       y = "")
  
```

In response to Bradley et al., Professor Frauke Kreuter who co-leads the Global CTIS writes "The (survey) quality is very difficult to assess, because there is usually no independently verified 'ground truth' or 'gold standard' with which to compare survey data." [@kreuter2021]. This rings even truer in the context of India and other developing economies where the gold standard estimates are deficient collecting the required information in some cases, defunct in others or not at all present in some others. Even in situations where the benchmark estimates are available, they have been called into question and validation is difficult due to lack of all the available data such as metadata and paradata (process data) of the surveys [@meyer2015]. The vaccine uptake example is a rare outlier and the official numbers are certainly as close to a "gold standard" as one can get. However, this is not true of majority if not all of the variables on which information is collected in sample surveys. Historically, official surveys such as the National Sample Survey (NSS) or National Family Health Survey (NFHS) have been considered to be the "gold standard" surveys in India. However, the lack of data on household incomes in NSS has led to researchers using data from a panel study called Indian Human Development Study (IHDS). More recently, several academic papers have been published [@malani2021] using survey data from a private entity called Centre for Monitoring Indian Economy (CMIE) primarily due to the lack of clarity on frequency and data quality of NSS's employment-unemployment surveys. This adoption has taken place despite issues of sample representativeness and methodology of surveys such as CMIE conducted by private sector [@somanchi2021; @bhalla]. Going forwards, it is clear that any research in social sciences has has to make use of data coming in all shapes and forms. For surveys with biased samples, novel techniques such as Multilevel Regression and Poststratification (also known as Mister P or MRP) have shown promise in correcting the survey biases [@wang2015].

As Professor Kreuter writes, "For certain inferential tasks, surveys with deficiencies can be useful. The usefulness of a data set can be evaluated only in the context of a specific research question." We agree with one caveat that the survey methods and data including metadata and process data be made available transparently. This means embracing more openness in all forms - accessibility, availability and less transaction costs in general to acquire the needed information.

# Data Availability

Data used in the analysis come from various sources. CTIS aggregate estimates at state and national levels are obtained from UMD's Global CTIS Open Data API. CTIS Microdata is made available through UMD's Global CTIS Microdata Repository to researchers upon request. Separately, an R interface to access UMD's Open Data and Microdata APIs is made available as an R package (<https://github.com/am0505/ctisglobal>). While CTIS open data estimates are made publicly available for other countries, we restrict our analysis to India. Administrative data for states and national level in India on COVID-19 is obtained from COVID19Bharat (<https://covid19bharat.org/>). Data on state and national level population by subgroups is obtained from Population Projections Report by Census of India 2011 (<https://nhm.gov.in/New_Updates_2018/Report_Population_Projection_2019.pdf>).

# Code Availability

Code used to produce these analyses is available on GitHub at <https://github.com/am0505/ctis_paper>.

# References
